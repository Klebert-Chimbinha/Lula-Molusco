//Deixa a fita de Led Respirar atraves da medição de Millis
#include <FastLED.h>
//FastLED basics
#define NUM_LEDS 17
#define LED_PIN 5
#define LED_TYPE    WS2812

//Definição de Estado
int estado = 2;
// estado == 0 - Respiração
// estado == 1 - Trigged
// estado == 2 - aproximação

//Respiração 
//medidores millis
unsigned long int respira = 0;
unsigned long int inspira = 100;
unsigned long int expira = 500;
//lampadas
int t = (NUM_LEDS - 1)/2; //Traqueia
int d = t + 1; //Bronquio direito
int e = t - 1; //Bronquio esquerdo
int ex = (NUM_LEDS - 1); // expiração 
int ex2 = 0; // expiração

//Aproximação
//medidores de Millis
unsigned long int gatilho = 0;
unsigned long int tiro = 10000;
//Lampadas
int g = 0;

//Trigged
unsigned long int ameaca = 0;

//CRGB leds
CRGB leds[NUM_LEDS];

void setup () {
  FastLED.addLeds<LED_TYPE, LED_PIN, GRB>(leds, NUM_LEDS);
  FastLED.setBrightness(250);
  }

void loop() {
  //int perto = map(analogRead(A0),0, 1023, 0, 1000);
  //if(10 > perto >= 1){
    //estado = 1;
  //} else if(perto > 10){
    //estado = 2;
  //}
  if(estado == 0){
    //respiração basica;
    if(d < NUM_LEDS){ 
      if(millis() - respira >= inspira){
        leds[t] = CRGB::Blue;
        leds[d] = CRGB::Amethyst;
        leds[e] = CRGB::Amethyst;
        FastLED.show();
        respira += inspira;
        d += 1;
        e -= 1;
      }
    }
    if(d == NUM_LEDS){
      if(millis() - respira >= expira){
        leds[t] = CRGB::Black;
        leds[ex] = CRGB::Black;
        leds[ex2] = CRGB::Black;
        FastLED.show();
        respira += expira;
        ex -= 1;
        ex2 +=1;
      }
      leds[t] = CRGB::CRGB::MediumPurple;
      FastLED.show();
    }
    if(d == NUM_LEDS and ex == t + 1){
      d = t + 1;
      e = t - 1;
      ex = (NUM_LEDS - 1);
      ex2 = 0;
    }
//Aproximação
  }else if (estado == 1){
    if(millis() - gatilho == tiro*0.1){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Red;
        FastLED.show(); 
      }
    }else if(millis() - gatilho == tiro*0.2){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Black;
        FastLED.show();
      } 
    }else if(millis() - gatilho == tiro*0.3){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Red;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro*0.4){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Black;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro*0.5){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Red;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro*0.6){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Black;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro*0.7){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Red;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro*0.8){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Black;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro*0.9){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Red;
        FastLED.show();
      }
    }else if(millis() - gatilho == tiro){
      for(int i = 0; i <= NUM_LEDS; i++){
        leds[i] = CRGB::Black;
        FastLED.show();
      }
      gatilho += tiro;
    }
//Engatilhado
  } else if (estado == 2){
  //int proximo = map(analogRead(A0),0, 1023, 10000, 10);

    if(millis() - ameaca >= 5000){
      for(int i = 0; i <=NUM_LEDS; i++){
        leds[i] = CRGB::Red;
        FastLED.show();
      }
    }
    if (millis() - ameaca >= 10000){
     for(int i = 0; i <=NUM_LEDS; i++){
        leds[i] = CRGB::Blue;
        FastLED.show();
        }
        ameaca += 10000;
      }
  }
}
