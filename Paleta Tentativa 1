#include <FastLED.h> //Adiciona a Biblioteca

#define NUM_LEDS 30 //Numero da fita de Leds da Demo
#define LED_PIN 5 //Mudar para 26 no fisico
#define LED_TYPE    WS2812
#define FRAMES_PER_SECOND 10 

bool gReverseDirection = false;
unsigned long int respira = 0; //Contador de Millis Universal
int r = 0; //Acendedor de Lampadas
int e = NUM_LEDS - 1; //Apagador de Lampadas
int estado = 0; //Define modo

CRGB leds[NUM_LEDS];

CRGBPalette16 currentPalette;
TBlendType    currentBlending;

void setup () {
  FastLED.addLeds<LED_TYPE, LED_PIN, GRB>(leds, NUM_LEDS);
  FastLED.setBrightness(250);
  
  currentPalette = RainbowColors_p;
  currentBlending = LINEARBLEND;

  }
  
//Loop
void loop() {
  //Para quandou ouver entrada, e mudar o estado
  //int proximo = map(analogRead(A0),1023, 0, 1000, 10);
  //if(proximo <= 1000){
    //estado = 1;
  //}
  
  //Respiração Básica
  if(estado == 0){
    Respirando(50, 50); //Respiração em Canudo e nas cores dos Xacras como proposto pelo Paulo Teles
  }
  
  //Pessoa entra no perimetro
  
}

CRGBPalette16 Nossa_Paleta =
     { FF0000, 0x000409, 0x00030B, 0x00030D, 0x000210, 0x000212, 0x000114, 0x000117, 
      0x000019, 0x00001C, 0x000026, 0x000031, 0x00003B, 0x000046, 0x14554B, 0x28AA50 };

void Respirando( int inspira, int expira) {
  if(r < NUM_LEDS){
    if(millis() - respira >= inspira){
      Arcoiris(r);
      blur1d(leds, NUM_LEDS, 10);
      FastLED.show();
      respira += inspira;
      r += 1;
      }
    }
    if(r == NUM_LEDS){
      if(millis() - respira >= expira){
        leds[e] = CRGB::Black;
        //blur1d(leds, NUM_LEDS, 15);
        fadeToBlackBy(leds, NUM_LEDS, 24);
        FastLED.show();
        respira += expira;
        e -= 1;
        }
      }
      if(r == NUM_LEDS and e == 0){
        r = 0;
        e = NUM_LEDS - 1;
      }
}
void Arcoiris(int r ){
  int intervalo = NUM_LEDS/7;
  if(r + 1 <= intervalo){

    leds[r] = ColorFromPalette( Nossa_Paleta, 1000, 255, currentBlending);   //leds[r] = CRGB::Violet;
  }else if(r + 1 <= 2*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 7000, 255, currentBlending);    //leds[r] = CRGB::Indigo;
  }else if(r + 1 <= 3*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 6000, 255, currentBlending);      //leds[r] = CRGB::Cyan;
  }else if(r + 1 <= 4*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 5000, 255, currentBlending);     // leds[r] = CRGB::Green;
  }else if (r + 1 <= 5*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 4000, 255, currentBlending);     // leds[r] = CRGB::Yellow;
  }else if (r + 1 <= 6*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 3000, 255, currentBlending);      //leds[r] = CRGB::Orange;
  }else if(r + 1 <= 7*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 2000, 255, currentBlending);      //leds[r] = CRGB::Red;
  }else if( r + 1 >= 7*intervalo){
    leds[r] = ColorFromPalette( Nossa_Paleta, 1000, 255, currentBlending);       //leds[r] = CRGB::Violet;
  }
  }

